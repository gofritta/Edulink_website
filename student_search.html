<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Search student</title>
    <link rel="stylesheet" href="student_search.css"> <!-- Link to your CSS file -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css"  />
    <script src="student_search.js" defer></script>
    <script src="pfp_student.js" defer></script>


</head>
<body>

<nav class="sidebar">
    <ul>
        <li><a class="active" href="#">HOME</a></li>
        <li><a href="#">About</a></li>
        <li><a href="#">Contact</a></li>
        <li class="dropdown"><a class="join-us-button" href="#"><img id="profile-picture" src="user.png" alt="Pfp" /></a>
            <div class="dropdown-content">

                </a><a href="#">My Account</a>

                <a href="#">My Account</a>

                <a href="#">Log Out</a>
            </div>
        </li>
        <li onclick="hideSidebar()"><a href="#"><svg xmlns="http://www.w3.org/2000/svg" height="26" viewBox="0 96 960 960" width="26"><path d="m249 849-42-42 231-231-231-231 42-42 231 231 231-231 42 42-231 231 231 231-42 42-231-231-231 231Z"/></svg></a></li>
    </ul>
</nav>

<nav>
    <label class="logo"><img src="edulink0.png" alt="Logo" /></label>
    <ul>
        <li><a class="hideOnMobile active" href="#">HOME</a></li>
        <li><a class="hideOnMobile" href="#">About</a></li>
        <li><a class="hideOnMobile" href="#">Contact</a></li>
        <li class="dropdown"><a class="hideOnMobile join-us-button" href="#"><img id="profile-picture" src="user.png" alt="Pfp" /></a>
            <div class="dropdown-content">
                <a href="#">My Account</a>
                <a href="#">Log Out</a>
            </div>
        </li>
        <li class="menu-button" onclick="showSidebar()"><a href="#"><svg xmlns="http://www.w3.org/2000/svg" height="26" viewBox="0 96 960 960" width="26"><path d="M120 816v-60h720v60H120Zm0-210v-60h720v60H120Zm0-210v-60h720v60H120Z"/></svg></a></li>
    </ul>
</nav>

<script>
    function showSidebar() {
        const sidebar = document.querySelector('.sidebar');
        sidebar.style.display = 'block';
    }

    function hideSidebar() {
        const sidebar = document.querySelector('.sidebar');
        sidebar.style.display = 'none';
    }
</script>

<div class="title-section">
    <h1>Hello, Student's Name!</h1>
    <p class="subtitle">Let's Find What Suits You Best</p>
    <hr class="divider">

    <!--- Search section ***********************************************************-->
   
    <div class="search-box">
        <input  type="text" placeholder="Search..." id="search-input">
        <button type="button" id="search-button">Search</button>
    </div>
</div>

<!--**********************************************************************************-->
<div class="wrapper">
       
    <i id="left" class="fa-solid fa-angle-left"></i>
    <ul class="carousel">
        <li class="card">
            <div class="img"><img src="imag/img1.jpg" draggable="false"></div>
            
            <h2 id="titre1"></h2>

            <span id="bienvenue1">  </span>

            <a href="ecole-profile.html?id=1"><button id="view-more-btn" class="button">View More</button></a>


        </li>
    
        <li class="card">
            <div class="img"><img src="imag/img1.jpg" draggable="false"></div>
            <h2 id="titre2"></h2>
            <span id="bienvenue2"></span>

            <a href="ecole-profile.html?id=2"><button id="view-more-btn" class="button">View More</button></a>

            

        </li>
        <li class="card">
            <div class="img"><img src="imag/img1.jpg" draggable="false"></div>
            <h2 id="titre3"></h2>
            <span id="bienvenue3" style="font-size: 2Opx;"></span>

            <a href="ecole-profile.html?id=3"><button id="view-more-btn" class="button">View More</button></a>

            
        </li>

    </ul>

    <i id="right" class="fa-solid fa-angle-right"></i>
</div>
<div id="placeholder" style="display: block;">
    <img id="placeholder-icon" src="pin.gif" alt="Placeholder Icon" />
    <p>Enter the state you live in the search bar and click on 'Search' to see the results.</p>
</div>

<script>
    
    const stateInput = document.getElementById('search-input');
    const searchBtn = document.getElementById('search-button');

    searchBtn.addEventListener('click', () => {
    const state = stateInput.value;

    /*
    let request = new XMLHttpRequest();
    request.open("GET", `http://127.0.0.1:3000/school?state_sch=${state}`)
    request.responseType = "json"
    request.send()
    request.onreadystatechange = function() {
        let schools = request.response;
                    
            console.log(schools)
            document.getElementById("titre1").innerHTML = `Ecole ${schools[0].name_sch}`
            document.getElementById("bienvenue1").innerHTML = ` Bienvenue à l'école de ${schools[0].name_sch} `
            document.getElementById("titre2").innerHTML = `Ecole ${schools[1].name_sch}`
            document.getElementById("bienvenue2").innerHTML = ` Bienvenue à l'école de ${schools[1].name_sch} `
            document.getElementById("titre3").innerHTML = `Ecole ${schools[2].name_sch}`
            document.getElementById("bienvenue3").innerHTML = ` Bienvenue à l'école de ${schools[2].name_sch} `
            
            /*const schoolDataString = JSON.stringify(schools);

            localStorage.setItem('ecolesWilaya', schoolDataString);

            /*
            const school1ID = JSON.stringify(schools[0].id_sch);
            const school2ID = JSON.stringify(schools[1].id_sch);
            const school3ID = JSON.stringify(schools[3].id_sch);

        
        const school1ID = schools[0].id_sch;
        const school2ID = schools[1].id_sch;
        const school3ID = schools[2].id_sch;

            localStorage.setItem('school1', school1ID);
            localStorage.setItem('school2', school2ID);
            localStorage.setItem('school3', school3ID);
             
            console.log(request.response);
        
    }
    */
    fetch(`http://127.0.0.1:3000/school?state_sch=${state}`, {
    method: 'GET'
    })
    .then(response => response.json())
    .then(response => {
    console.log(response)
    document.getElementById("titre1").innerHTML = `Ecole ${response[0].name_sch}`
    document.getElementById("bienvenue1").innerHTML = ` Bienvenue à l'école de ${response[0].name_sch} `
    document.getElementById("titre2").innerHTML = `Ecole ${response[1].name_sch}`
    document.getElementById("bienvenue2").innerHTML = ` Bienvenue à l'école de ${response[1].name_sch} `
    
    const school1ID = response[0].id_sch;
    const school2ID = response[1].id_sch;
    
    localStorage.setItem('school1', school1ID);
    localStorage.setItem('school2', school2ID);

    if(response[2]){
        document.getElementById("titre3").innerHTML = `Ecole ${response[2].name_sch}`
        document.getElementById("bienvenue3").innerHTML = ` Bienvenue à l'école de ${response[2].name_sch} `
    
        const school3ID = response[2].id_sch;
        localStorage.setItem('school3', school3ID);
        }

    
     
    })
    .catch((error) =>
        console.error(error)
    );

});

const viewMoreButtons = document.querySelectorAll('.view-more-btn');

viewMoreButtons.forEach(button => {
  button.addEventListener('click', (event) => {
    event.preventDefault();
    const schoolId = event.target.parentNode.querySelector('a').href.split('?id=')[1];
    window.location.href = `ecole-profile.html?id=${index}`;
  });
});

</script>

</body>
</html>
